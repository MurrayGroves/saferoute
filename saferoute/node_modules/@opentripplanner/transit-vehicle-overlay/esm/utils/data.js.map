{"version":3,"sources":["../../src/utils/data.js"],"names":["linterIgnoreTheseProps","str","val","retVal","e","console","error","getVehicleId","vehicleObjectOrString","queryId","String","blockId","tripId","findVehicleById","vehicleList","defVal","some","v","triMetRouteToShortName","route","convertTriMetRecord","rec","qt","secs","Math","round","time","date","Date","toLocaleString","agencyId","id","vehicleID","blockID","vehicleId","routeId","routeNumber","shapeId","tripID","directionId","direction","stopId","nextLocID","stopSequence","nextStopSeq","lat","latitude","lon","longitude","heading","bearing","routeType","type","routeShortName","routeLongName","signMessage","reportDate","seconds","status","convertAltData","feed","resultSet","vehicle","queryTime","map"],"mappings":"AAAA;;AAEA;AACA,OAAO,SAASA,sBAAT,GAAkC,CAAE;AAE3C;;AACA,OAAO,SAASC,GAAT,CAAaC,GAAb,EAAkB;AACvB,MAAIC,MAAM,GAAG,EAAb;;AACA,MAAI;AACFA,IAAAA,MAAM,aAAMD,GAAN,CAAN;AACD,GAFD,CAEE,OAAOE,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACD;;AACD,SAAOD,MAAP;AACD;AAED;;AACA,OAAO,SAASI,YAAT,CAAsBC,qBAAtB,EAA6C;AAClD,MAAIC,OAAO,GAAG,IAAd;;AACA,MAAID,qBAAJ,EAA2B;AACzB,QACE,OAAOA,qBAAP,KAAiC,QAAjC,IACAA,qBAAqB,YAAYE,MAFnC,EAIED,OAAO,GAAGD,qBAAV,CAJF,KAKK,IAAIA,qBAAqB,CAACG,OAA1B,EACHF,OAAO,GAAGD,qBAAqB,CAACG,OAAhC,CADG,KAEA,IAAIH,qBAAqB,CAACI,MAA1B,EACHH,OAAO,GAAGD,qBAAqB,CAACI,MAAhC;AACH;;AACD,SAAOH,OAAP;AACD;AAED;;AACA,OAAO,SAASI,eAAT,CAAyBC,WAAzB,EAAsCL,OAAtC,EAA8D;AAAA,MAAfM,MAAe,uEAAN,IAAM;AACnE,MAAIZ,MAAM,GAAGY,MAAb;;AACA,MAAI;AACF,QAAID,WAAW,IAAIL,OAAnB,EAA4B;AAC1BK,MAAAA,WAAW,CAACE,IAAZ,CAAiB,UAAAC,CAAC,EAAI;AACpB,YAAIR,OAAO,KAAKQ,CAAC,CAACN,OAAd,IAAyBF,OAAO,KAAKQ,CAAC,CAACL,MAA3C,EAAmD;AACjDT,UAAAA,MAAM,GAAGc,CAAT;AACA,iBAAO,IAAP;AACD;;AACD,eAAO,KAAP;AACD,OAND;AAOD;AACF,GAVD,CAUE,OAAOb,CAAP,EAAU;AACVC,IAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACD;;AACD,SAAOD,MAAP;AACD;AAED;AACA;AACA;AACA;;AACA,OAAO,SAASe,sBAAT,CAAgCC,KAAhC,EAAuC;AAC5C,MAAIhB,MAAM,GAAG,EAAb;;AACA,UAAQgB,KAAR;AACE,SAAK,EAAL;AACEhB,MAAAA,MAAM,GAAG,SAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,UAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,YAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,WAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,YAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,KAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,aAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,YAAT;AACA;;AACF,SAAK,GAAL;AACEA,MAAAA,MAAM,GAAG,YAAT;AACA;;AACF;AACEA,MAAAA,MAAM,GAAGF,GAAG,CAACkB,KAAD,CAAZ;AACA;AA9BJ;;AAgCA,SAAOhB,MAAP;AACD;AAED;AACA;AACA;AACA;;AACA,OAAO,SAASiB,mBAAT,CAA6BC,GAA7B,EAAkCC,EAAlC,EAAsC;AAC3C,MAAMC,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAW,CAACH,EAAE,GAAGD,GAAG,CAACK,IAAV,IAAkB,IAA7B,CAAb;AACA,MAAMC,IAAI,GAAG,IAAIC,IAAJ,CAASP,GAAG,CAACK,IAAb,EAAmBG,cAAnB,EAAb;AAEA,MAAM1B,MAAM,GAAG;AACb2B,IAAAA,QAAQ,EAAE,QADG;AAEbC,IAAAA,EAAE,YAAKV,GAAG,CAACW,SAAT,cAAsBX,GAAG,CAACY,OAA1B,CAFW;AAGbC,IAAAA,SAAS,EAAEjC,GAAG,CAACoB,GAAG,CAACW,SAAL,CAHD;AAIbG,IAAAA,OAAO,EAAElC,GAAG,CAACoB,GAAG,CAACe,WAAL,CAJC;AAKbzB,IAAAA,OAAO,EAAEV,GAAG,CAACoB,GAAG,CAACY,OAAL,CALC;AAMbI,IAAAA,OAAO,EAAE,IANI;AAObzB,IAAAA,MAAM,EAAEX,GAAG,CAACoB,GAAG,CAACiB,MAAL,CAPE;AAQbC,IAAAA,WAAW,EAAEtC,GAAG,CAACoB,GAAG,CAACmB,SAAL,CARH;AASbC,IAAAA,MAAM,EAAExC,GAAG,CAACoB,GAAG,CAACqB,SAAL,CATE;AAUbC,IAAAA,YAAY,EAAEtB,GAAG,CAACuB,WAVL;AAWbC,IAAAA,GAAG,EAAExB,GAAG,CAACyB,QAXI;AAYbC,IAAAA,GAAG,EAAE1B,GAAG,CAAC2B,SAZI;AAabC,IAAAA,OAAO,EAAE5B,GAAG,CAAC6B,OAbA;AAcbC,IAAAA,SAAS,EAAE9B,GAAG,CAAC+B,IAAJ,KAAa,MAAb,GAAsB,MAAtB,GAA+B,KAd7B;AAebC,IAAAA,cAAc,EAAEnC,sBAAsB,CAACG,GAAG,CAACe,WAAL,CAfzB;AAgBbkB,IAAAA,aAAa,EAAEjC,GAAG,CAACkC,WAhBN;AAiBbC,IAAAA,UAAU,EAAE7B,IAjBC;AAkBb8B,IAAAA,OAAO,EAAElC,IAlBI;AAmBbmC,IAAAA,MAAM,EAAE;AAnBK,GAAf;AAqBA,SAAOvD,MAAP;AACD;AAED;AACA;AACA;AACA;;AACA,OAAO,SAASwD,cAAT,CAAwBC,IAAxB,EAA8B;AACnC,MAAIzD,MAAM,GAAG,EAAb;;AACA,MAAIyD,IAAI,IAAIA,IAAI,CAACC,SAAb,IAA0BD,IAAI,CAACC,SAAL,CAAeC,OAA7C,EAAsD;AACpD,QAAMxC,EAAE,GAAGsC,IAAI,CAACC,SAAL,CAAeE,SAA1B;AACA5D,IAAAA,MAAM,GAAGyD,IAAI,CAACC,SAAL,CAAeC,OAAf,CAAuBE,GAAvB,CAA2B,UAAA3C,GAAG;AAAA,aAAID,mBAAmB,CAACC,GAAD,EAAMC,EAAN,CAAvB;AAAA,KAA9B,CAAT;AACD;;AACD,SAAOnB,MAAP;AACD","sourcesContent":["/** utility functions for converting and manipulating vehicle data */\n\n/** this function is used to have props that are not used w/out lint errors */\nexport function linterIgnoreTheseProps() {}\n\n/** simple (python-esque) conversion of an int to a string */\nexport function str(val) {\n  let retVal = \"\";\n  try {\n    retVal = `${val}`;\n  } catch (e) {\n    console.error(e);\n  }\n  return retVal;\n}\n\n/** gets best appropriate vehicle tracker id from input parameter based on type and data */\nexport function getVehicleId(vehicleObjectOrString) {\n  let queryId = null;\n  if (vehicleObjectOrString) {\n    if (\n      typeof vehicleObjectOrString === \"string\" ||\n      vehicleObjectOrString instanceof String\n    )\n      queryId = vehicleObjectOrString;\n    else if (vehicleObjectOrString.blockId)\n      queryId = vehicleObjectOrString.blockId;\n    else if (vehicleObjectOrString.tripId)\n      queryId = vehicleObjectOrString.tripId;\n  }\n  return queryId;\n}\n\n/** find a vehicle by block or trip id from a list of vehicles */\nexport function findVehicleById(vehicleList, queryId, defVal = null) {\n  let retVal = defVal;\n  try {\n    if (vehicleList && queryId) {\n      vehicleList.some(v => {\n        if (queryId === v.blockId || queryId === v.tripId) {\n          retVal = v;\n          return true;\n        }\n        return false;\n      });\n    }\n  } catch (e) {\n    console.error(e);\n  }\n  return retVal;\n}\n\n/**\n * make a short name (good for tooltips)\n * this routine used for converting a developer.trimet.org response (see below)\n */\nexport function triMetRouteToShortName(route) {\n  let retVal = \"\";\n  switch (route) {\n    case 90:\n      retVal = \"MAX Red\";\n      break;\n    case 100:\n      retVal = \"MAX Blue\";\n      break;\n    case 190:\n      retVal = \"MAX Yellow\";\n      break;\n    case 200:\n      retVal = \"MAX Green\";\n      break;\n    case 290:\n      retVal = \"MAX Orange\";\n      break;\n    case 203:\n      retVal = \"WES\";\n      break;\n    case 193:\n      retVal = \"PSC NS Line\";\n      break;\n    case 194:\n      retVal = \"PSC A-Loop\";\n      break;\n    case 195:\n      retVal = \"PSC B-Loop\";\n      break;\n    default:\n      retVal = str(route);\n      break;\n  }\n  return retVal;\n}\n\n/**\n * convert a developer.trimet.org vehicle object to the\n * @opentripplanner/core-utils/types/transitVehicleType object format\n */\nexport function convertTriMetRecord(rec, qt) {\n  const secs = Math.round((qt - rec.time) / 1000);\n  const date = new Date(rec.time).toLocaleString();\n\n  const retVal = {\n    agencyId: \"TRIMET\",\n    id: `${rec.vehicleID}+${rec.blockID}`,\n    vehicleId: str(rec.vehicleID),\n    routeId: str(rec.routeNumber),\n    blockId: str(rec.blockID),\n    shapeId: null,\n    tripId: str(rec.tripID),\n    directionId: str(rec.direction),\n    stopId: str(rec.nextLocID),\n    stopSequence: rec.nextStopSeq,\n    lat: rec.latitude,\n    lon: rec.longitude,\n    heading: rec.bearing,\n    routeType: rec.type === \"rail\" ? \"TRAM\" : \"BUS\",\n    routeShortName: triMetRouteToShortName(rec.routeNumber),\n    routeLongName: rec.signMessage,\n    reportDate: date,\n    seconds: secs,\n    status: \"IN_TRANSIT_TO\"\n  };\n  return retVal;\n}\n\n/**\n * convert list of developer.trimet.org vehicle objects to format used in this component\n * curl \"https://developer.trimet.org/ws/v2/vehicles/appid/B393B2CE96A258A72BAB481CA\"\n */\nexport function convertAltData(feed) {\n  let retVal = [];\n  if (feed && feed.resultSet && feed.resultSet.vehicle) {\n    const qt = feed.resultSet.queryTime;\n    retVal = feed.resultSet.vehicle.map(rec => convertTriMetRecord(rec, qt));\n  }\n  return retVal;\n}\n"],"file":"data.js"}